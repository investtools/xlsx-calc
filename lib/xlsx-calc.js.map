{"version":3,"sources":["webpack://XLSX_CALC_ASYNC/webpack/universalModuleDefinition","webpack://XLSX_CALC_ASYNC/webpack/bootstrap","webpack://XLSX_CALC_ASYNC/./src/RawValue.js","webpack://XLSX_CALC_ASYNC/./src/int_2_col_str.js","webpack://XLSX_CALC_ASYNC/./src/col_str_2_int.js","webpack://XLSX_CALC_ASYNC/./src/RefValue.js","webpack://XLSX_CALC_ASYNC/./src/getSanitizedSheetName.js","webpack://XLSX_CALC_ASYNC/./src/Range.js","webpack://XLSX_CALC_ASYNC/./src/resolve_promises.js","webpack://XLSX_CALC_ASYNC/./src/find_all_cells_with_formulas.js","webpack://XLSX_CALC_ASYNC/./src/index.js","webpack://XLSX_CALC_ASYNC/./src/exec_formula.js","webpack://XLSX_CALC_ASYNC/./src/Exp.js","webpack://XLSX_CALC_ASYNC/./src/UserFnExecutor.js","webpack://XLSX_CALC_ASYNC/./src/UserRawFnExecutor.js","webpack://XLSX_CALC_ASYNC/./src/formulas.js","webpack://XLSX_CALC_ASYNC/./src/formulas-raw.js","webpack://XLSX_CALC_ASYNC/./src/Calculator.js"],"names":["root","factory","exports","module","define","amd","this","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","setValue","v","calc","modulo","dividend","columnName","guard","String","fromCharCode","col_str","colstr","replace","length","Math","pow","charCodeAt","getSanitizedSheetName","str_expression","formula","self","parseRef","sheet","sheet_name","cell_name","indexOf","aux","split","wb","Sheets","Error","cell_full_name","Promise","resolve","reject","resolved_ref","formula_ref","status","exec_formula","then","res","catch","w","quotedMatch","match","col_str_2_int","int_2_col_str","range_expression","max_row","arr","min_row","parseInt","str_max_row","min_col","max_col","matrix","rej","promiseInSeq","_row","row","push","j","e","RawValue","args","promises","new_args","arg","val_or_promise","all","cells","f","cell","find_all_cells_with_formulas","Calculator","XLSX_CALC","workbook","exec_next","formulas","x","err","calculator","set_fx","exec_fx","import_functions","import_raw_functions","Exp","UserFnExecutor","UserRawFnExecutor","xlsx_Fx","xlsx_raw_Fx","common_operations","*","+","-","/","^","&","<",">","=","functions","opts","formulajs","prefix","obj","my_assign","dest","source","JSON","parse","stringify","k","build_expression","root_exp","str_formula","substr","exp_obj","buffer","is_string","was_string","fn_stack","exp","trim_buffer","trim","special","special_raw","stack","pop","update_cell_value","fn","apply","RefValue","Range","resolve_promises","exp_id","last_arg","handleException","message","exec","op","splice","console","error","id","hasPromise","concat","exec_minus","a","b","log","isNaN","user_function","map","FLOOR","floor","_xlfn.FLOOR.MATH","ABS","abs","SQRT","sqrt","VLOOKUP","return_index","MAX","max","arguments","Array","isArray","SUM","sum","MIN","result","CONCATENATE","IF","condition","_then","_else","PMT","rate_per_period","number_of_payments","present_value","future_value","type","q","COUNTA","counta","IRR","range","guess","min","guest","NPV","NORM.INV","normsInv","_xlfn.NORM.INV","STDEV","array","getArrayOfNumbers","mean","reduce","_mean","dev","itm","AVERAGE","avg","EXP","E","LN","_xlfn.VAR.P","var_p","VAR.P","_xlfn.COVARIANCE.P","covariance_p","COVARIANCE.P","TRIM","LEN","ISBLANK","inv_n","avg_a","avg_b","average","undefined","mu","sigma","Infinity","val","resolveOnErrorValue","onerrorvalue","v_or_promise","OFFSET","cell_ref","rows","columns","height","width","ref_value","parsed_ref","col","end_range","IFERROR","[object Object]","expressions","variables","var_name","variable","forEach","setVarOfExpression"],"mappings":"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","file":"xlsx-calc.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"XLSX_CALC_ASYNC\"] = factory();\n\telse\n\t\troot[\"XLSX_CALC_ASYNC\"] = factory();\n})(this, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 8);\n","\"use strict\";\n\nmodule.exports = function RawValue(value) {\n    this.setValue = function(v) {\n        value = v;\n    };\n    this.calc = function() {\n        return value;\n    };\n};\n","\"use strict\";\n\nmodule.exports = function int_2_col_str(n) {\n    var dividend = n + 1;\n    var columnName = '';\n    var modulo;\n    var guard = 10;\n    while (dividend > 0 && guard--) {\n        modulo = (dividend - 1) % 26;\n        columnName = String.fromCharCode(modulo + 65) + columnName;\n        dividend = (dividend - modulo - 1) / 26;\n    }\n    return columnName;\n};","\"use strict\";\n\nmodule.exports = function col_str_2_int(col_str) {\n    var r = 0;\n    var colstr = col_str.replace(/[0-9]+$/, '');\n    for (var i = colstr.length; i--;) {\n        r += Math.pow(26, colstr.length - i - 1) * (colstr.charCodeAt(i) - 64);\n    }\n    return r - 1;\n};","\"use strict\";\n\nconst getSanitizedSheetName = require('./getSanitizedSheetName.js');\n\nmodule.exports = function RefValue(str_expression, formula) {\n    var self = this;\n    this.name = 'RefValue';\n    this.str_expression = str_expression;\n    this.formula = formula;\n\n    self.parseRef = function() {\n        var sheet, sheet_name, cell_name, cell_full_name;\n        if (str_expression.indexOf('!') != -1) {\n            var aux = str_expression.split('!');\n            sheet_name = getSanitizedSheetName(aux[0]);\n            sheet = formula.wb.Sheets[sheet_name];\n            cell_name = aux[1];\n        }\n        else {\n            sheet = formula.sheet;\n            sheet_name = formula.sheet_name;\n            cell_name = str_expression;\n        }\n        if (!sheet) {\n            throw Error(\"Sheet \" + sheet_name + \" not found.\");\n        }\n        cell_full_name = sheet_name + '!' + cell_name;\n        return {\n            sheet: sheet,\n            sheet_name: sheet_name,\n            cell_name: cell_name,\n            cell_full_name: cell_full_name\n        };\n    };\n\n    this.calc = function() {\n        return new Promise((resolve, reject) => {\n            var resolved_ref = self.parseRef();\n            var sheet = resolved_ref.sheet;\n            var cell_name = resolved_ref.cell_name;\n            var cell_full_name = resolved_ref.cell_full_name;\n            var ref_cell = sheet[cell_name];\n            if (!ref_cell) {\n                return resolve(null);\n            }\n            var formula_ref = formula.formula_ref[cell_full_name];\n            if (formula_ref) {\n                if (formula_ref.status === 'new') {\n                    formula.exec_formula(formula_ref).then(res => {\n                        resolve(res);\n                    }).catch(reject);\n                    //return sheet[cell_name].v;\n                }\n                else if (formula_ref.status === 'working') {\n                    //console.log('Circular ref in Ref');\n                    reject('Circular ref');\n                    //throw new Error('Circular ref');\n                }\n                else if (formula_ref.status === 'done') {\n                    if (sheet[cell_name].t === 'e') {\n                        reject(sheet[cell_name].w);\n                        //console.log('ref is an error');\n                        //throw new Error(sheet[cell_name].w);\n                    }\n                    return resolve(sheet[cell_name].v);\n                }\n            }\n            else {\n                return resolve(sheet[cell_name].v);\n            }\n        });\n    };\n};\n","\"use strict\";\n\nmodule.exports = function getSanitizedSheetName(sheet_name) {\n    var quotedMatch = sheet_name.match(/^'(.*)'$/);\n    if (quotedMatch) {\n        return quotedMatch[1];\n    }\n    else {\n        return sheet_name;\n    }\n};\n","\"use strict\";\n\nconst col_str_2_int = require('./col_str_2_int.js');\nconst int_2_col_str = require('./int_2_col_str.js');\nconst getSanitizedSheetName = require('./getSanitizedSheetName.js');\n\nmodule.exports = function Range(str_expression, formula) {\n    \n    this.str_expression = str_expression;\n    \n    function promiseInSeq(sheet, matrix, min_row, max_row, min_col, max_col, sheet_name, resolve, reject, _row) {\n        //console.log('min_row =', min_row, 'max_row =', max_row);\n        //console.log('min_col =', min_col, 'max_col =', max_col);\n        for (let i = min_row; i <= max_row; i++) {\n            //console.log('ok i =', i);\n            let row;\n            if (_row) {\n                row = _row;\n            }\n            else {\n                row = [];\n                matrix.push(row);\n            }\n            for (let j = min_col; j <= max_col; j++) {\n                let cell_name = int_2_col_str(j) + i;\n                let cell_full_name = sheet_name + '!' + cell_name;\n                //console.log('range <<', cell_name, 'i =', i, 'j =', j);\n                if (formula.formula_ref[cell_full_name]) {\n                    if (formula.formula_ref[cell_full_name].status === 'working') {\n                        //console.log('Circular ref in range');\n                        reject('Circular ref');\n                        return;\n                    } else if (formula.formula_ref[cell_full_name].status === 'new') {\n                        formula.exec_formula(formula.formula_ref[cell_full_name]).then(r=>{\n                            row.push(sheet[cell_name].v);\n                            //console.log('recursao asincrona');\n                            j++;\n                            if (j > max_col) {\n                                j = 0;\n                                i++;\n                            }\n                            promiseInSeq(sheet, matrix, i, max_row, j, max_col, sheet_name, resolve, reject, row);\n                        }).catch(reject);\n                        return;\n                    } else if (formula.formula_ref[cell_full_name].status === 'done') {\n                        row.push(sheet[cell_name].v);\n                    }\n                }\n                else if (sheet[cell_name]) {\n                    row.push(sheet[cell_name].v);\n                }\n                else {\n                    row.push(null);\n                }\n            }\n        }\n        resolve();\n    }\n    \n    this.calc = function() {\n        return new Promise((resolve, reject) => {\n            try {\n                var range_expression, sheet_name, sheet;\n                if (str_expression.indexOf('!') != -1) {\n                    var aux = str_expression.split('!');\n                    sheet_name = getSanitizedSheetName(aux[0]);\n                    range_expression = aux[1];\n                }\n                else {\n                    sheet_name = formula.sheet_name;\n                    range_expression = str_expression;\n                }\n                sheet = formula.wb.Sheets[sheet_name];\n                var arr = range_expression.split(':');\n                var min_row = parseInt(arr[0].replace(/^[A-Z]+/, ''), 10) || 0;\n                var str_max_row = arr[1].replace(/^[A-Z]+/, '');\n                var max_row;\n                if (str_max_row === '' && sheet['!ref']) {\n                    str_max_row = sheet['!ref'].split(':')[1].replace(/^[A-Z]+/, '');\n                }\n                // the max is 1048576, but TLE\n                max_row = parseInt(str_max_row == '' ? '500000' : str_max_row, 10);\n                var min_col = col_str_2_int(arr[0]);\n                var max_col = col_str_2_int(arr[1]);\n                var matrix = [];\n                new Promise((res, rej) => {\n                    promiseInSeq(sheet, matrix, min_row, max_row, min_col, max_col, sheet_name, res, rej);\n                }).then(() => {\n                    resolve(matrix);\n                }).catch(reject);\n            } catch(e) {\n                reject(e);\n            }\n        });\n    };\n};\n","\"use strict\";\n\nconst RawValue = require('./RawValue.js');\n\nmodule.exports = function resolve_promises(args) {\n    //console.log('resolvendo promises...');\n    return new Promise((resolve, reject) => {\n        let promises = [],\n            new_args = [];\n        for (let i = 0; i < args.length; i++) {\n            let arg = args[i];\n            if (typeof arg === 'object' && typeof arg['calc'] === 'function') {\n                let val_or_promise = arg.calc();\n                if (typeof val_or_promise === 'object' && typeof val_or_promise['then'] === 'function') {\n                    promises.push(val_or_promise);\n                    val_or_promise.then(r => {\n                        new_args[i] = new RawValue(r);\n                    }).catch(reject);\n                }\n                else {\n                    new_args[i] = new RawValue(val_or_promise);\n                }\n            }\n            else {\n                new_args[i] = arg;\n            }\n        }\n        Promise.all(promises).then(() => {\n            //console.log('new_args =', new_args.map(a => a.calc()));\n            resolve(new_args);\n        }).catch(reject);\n    });\n};","\"use strict\";\n\nmodule.exports = function find_all_cells_with_formulas(wb, exec_formula) {\n    var formula_ref = {};\n    var cells = [];\n    for (var sheet_name in wb.Sheets) {\n        var sheet = wb.Sheets[sheet_name];\n        for (var cell_name in sheet) {\n            if (sheet[cell_name].f) {\n                var formula = formula_ref[sheet_name + '!' + cell_name] = {\n                    formula_ref: formula_ref,\n                    wb: wb,\n                    sheet: sheet,\n                    sheet_name: sheet_name,\n                    cell: sheet[cell_name],\n                    name: cell_name,\n                    status: 'new',\n                    exec_formula: exec_formula\n                };\n                cells.push(formula);\n            }\n        }\n    }\n    return cells;\n};\n","\"use strict\";\n\nconst int_2_col_str = require('./int_2_col_str.js');\nconst col_str_2_int = require('./col_str_2_int.js');\nconst exec_formula = require('./exec_formula.js');\nconst find_all_cells_with_formulas = require('./find_all_cells_with_formulas.js');\nconst Calculator = require('./Calculator.js');\n\n\nfunction exec_next(formulas, i, resolve, reject) {\n    if (i === formulas.length) {\n        resolve();\n        return;\n    }\n    //console.log('executing', i+1, 'of', formulas.length,'...');\n    exec_formula(formulas[i]).then(x => {\n        exec_next(formulas, i + 1, resolve, reject);\n    }).catch(err => {\n        //console.error(err);\n        reject(err);\n    });\n}\n\nvar XLSX_CALC = function(workbook) {\n    return new Promise((resolve, reject) => {\n        var formulas = find_all_cells_with_formulas(workbook, exec_formula);\n        exec_next(formulas, 0, resolve, reject);\n        //for (var i = formulas.length - 1; i >= 0; i--) {\n        //    exec_formula(formulas[i]);\n        //}\n        //resolve();\n    });\n};\n\nXLSX_CALC.calculator = function calculator(workbook) {\n    return new Calculator(workbook, exec_formula);\n};\n\nXLSX_CALC.set_fx = exec_formula.set_fx;\nXLSX_CALC.exec_fx = exec_formula.exec_fx;\nXLSX_CALC.col_str_2_int = col_str_2_int;\nXLSX_CALC.int_2_col_str = int_2_col_str;\nXLSX_CALC.import_functions = exec_formula.import_functions;\nXLSX_CALC.import_raw_functions = exec_formula.import_raw_functions;\n\n\n\nmodule.exports = XLSX_CALC;","\"use strict\";\n\nconst Exp = require('./Exp.js');\nconst RawValue = require('./RawValue.js');\nconst UserFnExecutor = require('./UserFnExecutor.js');\nconst UserRawFnExecutor = require('./UserRawFnExecutor.js');\n\nvar xlsx_Fx = {};\nvar xlsx_raw_Fx = {};\n\nimport_functions(require('./formulas.js'));\nimport_raw_functions(require('./formulas-raw.js'));\n\nconst common_operations = {\n    '*': 'multiply',\n    '+': 'plus',\n    '-': 'minus',\n    '/': 'divide',\n    '^': 'power',\n    '&': 'concat',\n    '<': 'lt',\n    '>': 'gt',\n    '=': 'eq'\n};\n\nfunction import_raw_functions(functions, opts) {\n    for (var key in functions) {\n        xlsx_raw_Fx[key] = functions[key];\n    }\n}\n\nfunction import_functions(formulajs, opts) {\n    opts = opts || {};\n    var prefix = opts.prefix || '';\n    for (var key in formulajs) {\n        var obj = formulajs[key];\n        if (typeof(obj) === 'function') {\n            xlsx_Fx[prefix + key] = obj;\n        }\n        else if (typeof(obj) === 'object') {\n            import_functions(obj, my_assign(opts, { prefix: key + '.' }));\n        }\n    }\n}\n\nfunction my_assign(dest, source) {\n    var obj = JSON.parse(JSON.stringify(dest));\n    for (var k in source) {\n        obj[k] = source[k];\n    }\n    return obj;\n}\n\nfunction build_expression(formula) {\n    formula.status = 'working';\n    var root_exp;\n    var str_formula = formula.cell.f;\n    if (str_formula[0] == '=') {\n        str_formula = str_formula.substr(1);\n    }\n    var exp_obj = root_exp = new Exp(formula);\n    var buffer = '',\n        is_string = false,\n        was_string = false;\n    var fn_stack = [{\n        exp: exp_obj\n    }];\n    for (var i = 0; i < str_formula.length; i++) {\n        if (str_formula[i] == '\"') {\n            if (is_string) {\n                exp_obj.push(new RawValue(buffer));\n                is_string = false;\n                was_string = true;\n            }\n            else {\n                is_string = true;\n            }\n            buffer = '';\n        }\n        else if (is_string) {\n            buffer += str_formula[i];\n        }\n        else if (str_formula[i] == '(') {\n            var o, trim_buffer = buffer.trim(),\n                special = xlsx_Fx[trim_buffer];\n            var special_raw = xlsx_raw_Fx[trim_buffer];\n            if (special_raw) {\n                special = new UserRawFnExecutor(special_raw, formula);\n            }\n            else if (special) {\n                special = new UserFnExecutor(special, formula);\n            }\n            else if (trim_buffer) {\n                //Error: \"Worksheet 1\"!D145: Function INDEX not found\n                throw new Error('\"' + formula.sheet_name + '\"!' + formula.name + ': Function ' + buffer + ' not found');\n            }\n            o = new Exp(formula);\n            fn_stack.push({\n                exp: o,\n                special: special\n            });\n            exp_obj = o;\n            buffer = '';\n        }\n        else if (common_operations[str_formula[i]]) {\n            if (!was_string) {\n                exp_obj.push(buffer);\n            }\n            was_string = false;\n            exp_obj.push(str_formula[i]);\n            buffer = '';\n        }\n        else if (str_formula[i] === ',' && fn_stack[fn_stack.length - 1].special) {\n            was_string = false;\n            fn_stack[fn_stack.length - 1].exp.push(buffer);\n            fn_stack[fn_stack.length - 1].special.push(fn_stack[fn_stack.length - 1].exp);\n            fn_stack[fn_stack.length - 1].exp = exp_obj = new Exp(formula);\n            buffer = '';\n        }\n        else if (str_formula[i] == ')') {\n            var v, stack = fn_stack.pop();\n            exp_obj = stack.exp;\n            exp_obj.push(buffer);\n            v = exp_obj;\n            buffer = '';\n            exp_obj = fn_stack[fn_stack.length - 1].exp;\n            if (stack.special) {\n                stack.special.push(v);\n                exp_obj.push(stack.special);\n            }\n            else {\n                exp_obj.push(v);\n            }\n        }\n        else {\n            buffer += str_formula[i];\n        }\n    }\n    root_exp.push(buffer);\n    return root_exp;\n}\n\nfunction exec_formula(formula) {\n    let root_exp = build_expression(formula);\n    return root_exp.update_cell_value();\n}\n\nexec_formula.set_fx = function set_fx(name, fn) {\n    xlsx_Fx[name] = fn;\n};\n\nexec_formula.exec_fx = function exec_fx(name, args) {\n    return xlsx_Fx[name].apply(this, args);\n};\n\nexec_formula.import_functions = import_functions;\nexec_formula.import_raw_functions = import_raw_functions;\nexec_formula.build_expression = build_expression;\nmodule.exports = exec_formula;\n","\"use strict\";\n\nconst RawValue = require('./RawValue.js');\nconst RefValue = require('./RefValue.js');\nconst Range = require('./Range.js');\nconst resolve_promises = require('./resolve_promises.js');\nlet exp_id = 0;\nlet exec_id = 0;\n\nmodule.exports = function Exp(formula) {\n    var self = this;\n    self.id = ++exp_id;\n    self.args = [];\n    self.name = 'Expression';\n    self.update_cell_value = update_cell_value;\n    self.formula = formula;\n    \n    function handleException(e, formula, resolve, reject) {\n        if (e.message == '#N/A') {\n            formula.cell.v = 42;\n            formula.cell.t = 'e';\n            formula.cell.w = e.message;\n            resolve();\n        }\n        else {\n            //console.error('Error', current_execution, e);\n            reject(e);\n            //throw e;\n        }\n    }\n    \n    function update_cell_value() {\n        let hasPromise = false;\n        return new Promise((resolve, reject) => {\n            //let current_execution = exec_id++;\n            try {\n                //console.log('Exec', current_execution, formula.name, formula.cell.f);\n                var val_or_promise = self.calc();\n                if (typeof val_or_promise === 'object' && typeof val_or_promise['then'] === 'function') {\n                    hasPromise = true;\n                    val_or_promise.then(res => {\n                        formula.cell.v = res;\n                        if (typeof(formula.cell.v) === 'string') {\n                            formula.cell.t = 's';\n                        }\n                        else if (typeof(formula.cell.v) === 'number') {\n                            formula.cell.t = 'n';\n                        }\n                        formula.status = 'done';\n                        resolve(formula.cell.v);\n                    }).catch(e => {\n                        //console.log('Exp', self.id, 'error:', e);\n                        //reject(e);\n                        formula.status = 'done';\n                        handleException(e, formula, resolve, reject);\n                    });\n                }\n                else {\n                    formula.cell.v = val_or_promise;\n                    if (typeof(formula.cell.v) === 'string') {\n                        formula.cell.t = 's';\n                    }\n                    else if (typeof(formula.cell.v) === 'number') {\n                        formula.cell.t = 'n';\n                    }\n                    resolve(formula.cell.v);\n                }\n            }\n            catch (e) {\n                handleException(e, formula, resolve, reject);\n            }\n            finally {\n                if (!hasPromise) {\n                    formula.status = 'done';\n                }\n            }\n        });\n    }\n    \n    function exec(op, args, fn) {\n        for (var i = 0; i < args.length; i++) {\n            if (args[i] === op) {\n                try {\n                    var r = fn(args[i - 1].calc(), args[i + 1].calc());\n                    args.splice(i - 1, 3, new RawValue(r));\n                    i--;\n                }\n                catch (e) {\n                    console.error(e);\n                    throw Error(formula.name + ': evaluating ' + formula.cell.f + '\\n' + e.message);\n                    //throw e;\n                }\n            }\n        }\n    }\n\n    function exec_minus(args) {\n        for (var i = args.length; i--;) {\n            if (args[i] === '-') {\n                var r = -args[i + 1].calc();\n                if (typeof args[i - 1] !== 'string' && i > 0) {\n                    args.splice(i, 1, '+');\n                    args.splice(i + 1, 1, new RawValue(r));\n                }\n                else {\n                    args.splice(i, 2, new RawValue(r));\n                }\n            }\n        }\n    }\n    \n    self.calc = function() {\n        return new Promise((resolve, reject) => {\n            resolve_promises(self.args.concat()).then(args => {\n                try {\n                    exec_minus(args);\n                    exec('^', args, function(a, b) {\n                        return Math.pow(+a, +b);\n                    });\n                    exec('*', args, function(a, b) {\n                        return (+a) * (+b);\n                    });\n                    exec('/', args, function(a, b) {\n                        return (+a) / (+b);\n                    });\n                    exec('+', args, function(a, b) {\n                        return (+a) + (+b);\n                    });\n                    exec('&', args, function(a, b) {\n                        return '' + a + b;\n                    });\n                    exec('<', args, function(a, b) {\n                        return a < b;\n                    });\n                    exec('>', args, function(a, b) {\n                        return a > b;\n                    });\n                    exec('>=', args, function(a, b) {\n                        return a >= b;\n                    });\n                    exec('<=', args, function(a, b) {\n                        return a <= b;\n                    });\n                    exec('<>', args, function(a, b) {\n                        return a != b;\n                    });\n                    exec('=', args, function(a, b) {\n                        return a == b;\n                    });\n                    if (args.length == 1) {\n                        if (typeof args[0] === 'object' && typeof args[0]['then'] === 'function') {\n                            args[0].then(resolve).catch(reject);\n                            return;\n                        }\n                        if (typeof(args[0].calc) != 'function') {\n                            return resolve(args[0]);\n                        }\n                        else {\n                            return resolve(args[0].calc());\n                        }\n                    }\n                    else {\n                        console.log('something is not right');\n                    }\n                } catch(e) {\n                    reject(e);\n                }\n            }).catch(reject);\n        });\n    };\n\n    var last_arg;\n    self.push = function(buffer) {\n        if (buffer) {\n            var v;\n            if (!isNaN(buffer)) {\n                v = new RawValue(+buffer);\n            }\n            else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[A-Z]+[0-9]+:[A-Z]+[0-9]+$/)) {\n                v = new Range(buffer.trim().replace(/\\$/g, ''), formula);\n            }\n            else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[^!]+![A-Z]+[0-9]+:[A-Z]+[0-9]+$/)) {\n                v = new Range(buffer.trim().replace(/\\$/g, ''), formula);\n            }\n            else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[A-Z]+:[A-Z]+$/)) {\n                v = new Range(buffer.trim().replace(/\\$/g, ''), formula);\n            }\n            else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[^!]+![A-Z]+:[A-Z]+$/)) {\n                v = new Range(buffer.trim().replace(/\\$/g, ''), formula);\n            }\n            else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[A-Z]+[0-9]+$/)) {\n                v = new RefValue(buffer.trim().replace(/\\$/g, ''), formula);\n            }\n            else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[^!]+![A-Z]+[0-9]+$/)) {\n                v = new RefValue(buffer.trim().replace(/\\$/g, ''), formula);\n            }\n            else if (typeof buffer === 'string' && !isNaN(buffer.trim().replace(/%$/, ''))) {\n                v = new RawValue(+(buffer.trim().replace(/%$/, '')) / 100.0);\n            }\n            else {\n                v = buffer;\n            }\n            if (((v === '=') && (last_arg == '>' || last_arg == '<')) || (last_arg == '<' && v === '>')) {\n                self.args[self.args.length - 1] += v;\n            }\n            else {\n                self.args.push(v);\n            }\n            last_arg = v;\n            //console.log(self.id, '-->', v);\n        }\n    };\n};","\"use strict\";\n\nconst resolve_promises = require('./resolve_promises.js');\n\nmodule.exports = function UserFnExecutor(user_function) {\n    var self = this;\n    self.name = 'UserFn';\n    self.args = [];\n    \n    self.calc = function() {\n        return new Promise((resolve, reject) => {\n            resolve_promises(self.args).then(args => {\n                try {\n                    resolve(user_function.apply(self, args.map(f=>f.calc())));\n                } catch(e) {\n                    reject(e);\n                }\n            }).catch(reject);\n        });\n    };\n    \n    self.push = function(buffer) {\n        self.args.push(buffer);\n    };\n    \n};","\"use strict\";\n\nmodule.exports = function UserRawFnExecutor(user_function) {\n    var self = this;\n    self.name = 'UserRawFn';\n    self.args = [];\n    self.calc = function() {\n        return user_function.apply(self, self.args);\n    };\n    self.push = function(buffer) {\n        self.args.push(buffer);\n    };\n};\n","\"use strict\";\n\n// +---------------------+\n// | FORMULAS REGISTERED |\n// +---------------------+\nlet formulas = {\n    'FLOOR': Math.floor,\n    '_xlfn.FLOOR.MATH': Math.floor,\n    'ABS': Math.abs,\n    'SQRT': Math.sqrt,\n    'VLOOKUP': vlookup,\n    'MAX': max,\n    'SUM': sum,\n    'MIN': min,\n    'CONCATENATE': concatenate,\n    'IF': _if,\n    'PMT': pmt,\n    'COUNTA': counta,\n    'IRR': irr,\n    'NORM.INV': normsInv,\n    '_xlfn.NORM.INV': normsInv,\n    'STDEV': stDeviation,\n    'AVERAGE': avg,\n    'EXP': EXP,\n    'LN': Math.log,\n    '_xlfn.VAR.P': var_p,\n    'VAR.P': var_p,\n    '_xlfn.COVARIANCE.P': covariance_p,\n    'COVARIANCE.P': covariance_p,\n    'TRIM': trim,\n    'LEN': len,\n    'ISBLANK': is_blank\n};\n\nfunction len(a) {\n    return ('' + a).length;\n}\n\nfunction trim(a) {\n    return ('' + a).trim();\n}\n\nfunction is_blank(a) {\n    return !a;\n}\n\nfunction covariance_p(a, b) {\n    a = getArrayOfNumbers(a);\n    b = getArrayOfNumbers(b);\n    if (a.length != b.length) {\n        return 'N/D';\n    }\n    var inv_n = 1.0 / a.length;\n    var avg_a = sum.apply(this, a) / a.length;\n    var avg_b = sum.apply(this, b) / b.length;\n    var s = 0.0;\n    for (var i = 0; i < a.length; i++) {\n        s += (a[i] - avg_a) * (b[i] - avg_b);\n    }\n    return s * inv_n;\n}\n\nfunction getArrayOfNumbers(range) {\n    var arr = [];\n    for (var i = 0; i < range.length; i++) {\n        var arg = range[i];\n        if (Array.isArray(arg)) {\n            var matrix = arg;\n            for (var j = matrix.length; j--;) {\n                if (typeof(matrix[j]) == 'number') {\n                    arr.push(matrix[j]);\n                }\n                else if (Array.isArray(matrix[j])) {\n                    for (var k = matrix[j].length; k--;) {\n                        if (typeof(matrix[j][k]) == 'number') {\n                            arr.push(matrix[j][k]);\n                        }\n                    }\n                }\n                // else {\n                //   wtf is that?\n                // }\n            }\n        }\n        else {\n            if (typeof(arg) == 'number') {\n                arr.push(arg);\n            }\n        }\n    }\n    return arr;\n}\n\nfunction var_p() {\n    var average = avg.apply(this, arguments);\n    var s = 0.0;\n    var c = 0;\n    for (var i = 0; i < arguments.length; i++) {\n        var arg = arguments[i];\n        if (Array.isArray(arg)) {\n            var matrix = arg;\n            for (var j = matrix.length; j--;) {\n                for (var k = matrix[j].length; k--;) {\n                    if (matrix[j][k] !== null && matrix[j][k] !== undefined) {\n                        s += Math.pow(matrix[j][k] - average, 2);\n                        c++;\n                    }\n                }\n            }\n        }\n        else {\n            s += Math.pow(arg - average, 2);\n            c++;\n        }\n    }\n    return s / c;\n}\n\nfunction EXP(n) {\n    return Math.pow(Math.E, n);\n}\n\nfunction avg() {\n    return sum.apply(this, arguments) / counta.apply(this, arguments);\n}\n\nfunction stDeviation() {\n    var array = getArrayOfNumbers(arguments);\n\n    function _mean(array) {\n        return array.reduce(function(a, b) {\n            return a + b;\n        }) / array.length;\n    }\n    var mean = _mean(array),\n        dev = array.map(function(itm) {\n            return (itm - mean) * (itm - mean);\n        });\n    return Math.sqrt(dev.reduce(function(a, b) {\n        return a + b;\n    }) / (array.length - 1));\n}\n\n/// Original C++ implementation found at http://www.wilmott.com/messageview.cfm?catid=10&threadid=38771\n/// C# implementation found at http://weblogs.asp.net/esanchez/archive/2010/07/29/a-quick-and-dirty-implementation-of-excel-norminv-function-in-c.aspx\n/*\n *     Compute the quantile function for the normal distribution.\n *\n *     For small to moderate probabilities, algorithm referenced\n *     below is used to obtain an initial approximation which is\n *     polished with a final Newton step.\n *\n *     For very large arguments, an algorithm of Wichura is used.\n *\n *  REFERENCE\n *\n *     Beasley, J. D. and S. G. Springer (1977).\n *     Algorithm AS 111: The percentage points of the normal distribution,\n *     Applied Statistics, 26, 118-121.\n *\n *      Wichura, M.J. (1988).\n *      Algorithm AS 241: The Percentage Points of the Normal Distribution.\n *      Applied Statistics, 37, 477-484.\n */\nfunction normsInv(p, mu, sigma) {\n    if (p < 0 || p > 1) {\n        throw \"The probality p must be bigger than 0 and smaller than 1\";\n    }\n    if (sigma < 0) {\n        throw \"The standard deviation sigma must be positive\";\n    }\n\n    if (p == 0) {\n        return -Infinity;\n    }\n    if (p == 1) {\n        return Infinity;\n    }\n    if (sigma == 0) {\n        return mu;\n    }\n\n    var q, r, val;\n\n    q = p - 0.5;\n\n    /*-- use AS 241 --- */\n    /* double ppnd16_(double *p, long *ifault)*/\n    /*      ALGORITHM AS241  APPL. STATIST. (1988) VOL. 37, NO. 3\n            Produces the normal deviate Z corresponding to a given lower\n            tail area of P; Z is accurate to about 1 part in 10**16.\n    */\n    if (Math.abs(q) <= .425) { /* 0.075 <= p <= 0.925 */\n        r = .180625 - q * q;\n        val =\n            q * (((((((r * 2509.0809287301226727 +\n                            33430.575583588128105) * r + 67265.770927008700853) * r +\n                        45921.953931549871457) * r + 13731.693765509461125) * r +\n                    1971.5909503065514427) * r + 133.14166789178437745) * r +\n                3.387132872796366608) / (((((((r * 5226.495278852854561 +\n                        28729.085735721942674) * r + 39307.89580009271061) * r +\n                    21213.794301586595867) * r + 5394.1960214247511077) * r +\n                687.1870074920579083) * r + 42.313330701600911252) * r + 1);\n    }\n    else { /* closer than 0.075 from {0,1} boundary */\n\n        /* r = min(p, 1-p) < 0.075 */\n        if (q > 0)\n            r = 1 - p;\n        else\n            r = p;\n\n        r = Math.sqrt(-Math.log(r));\n        /* r = sqrt(-log(r))  <==>  min(p, 1-p) = exp( - r^2 ) */\n\n        if (r <= 5) { /* <==> min(p,1-p) >= exp(-25) ~= 1.3888e-11 */\n            r += -1.6;\n            val = (((((((r * 7.7454501427834140764e-4 +\n                                .0227238449892691845833) * r + .24178072517745061177) *\n                            r + 1.27045825245236838258) * r +\n                        3.64784832476320460504) * r + 5.7694972214606914055) *\n                    r + 4.6303378461565452959) * r +\n                1.42343711074968357734) / (((((((r *\n                                1.05075007164441684324e-9 + 5.475938084995344946e-4) *\n                            r + .0151986665636164571966) * r +\n                        .14810397642748007459) * r + .68976733498510000455) *\n                    r + 1.6763848301838038494) * r +\n                2.05319162663775882187) * r + 1);\n        }\n        else { /* very close to  0 or 1 */\n            r += -5;\n            val = (((((((r * 2.01033439929228813265e-7 +\n                                2.71155556874348757815e-5) * r +\n                            .0012426609473880784386) * r + .026532189526576123093) *\n                        r + .29656057182850489123) * r +\n                    1.7848265399172913358) * r + 5.4637849111641143699) *\n                r + 6.6579046435011037772) / (((((((r *\n                            2.04426310338993978564e-15 + 1.4215117583164458887e-7) *\n                        r + 1.8463183175100546818e-5) * r +\n                    7.868691311456132591e-4) * r + .0148753612908506148525) * r + .13692988092273580531) * r +\n                .59983220655588793769) * r + 1);\n        }\n\n        if (q < 0.0) {\n            val = -val;\n        }\n    }\n\n    return mu + sigma * val;\n}\n\nfunction irr(range, guess) {\n    var min = -2.0;\n    var max = 1.0;\n    var n = 0;\n    do {\n        var guest = (min + max) / 2;\n        var NPV = 0;\n        for (var i = 0; i < range.length; i++) {\n            var arg = range[i];\n            NPV += arg[0] / Math.pow((1 + guest), i);\n        }\n        if (NPV > 0) {\n            if (min === max) {\n                max += Math.abs(guest);\n            }\n            min = guest;\n        }\n        else {\n            max = guest;\n        }\n        n++;\n    } while (Math.abs(NPV) > 0.000001 && n < 100000);\n    //console.log(n);\n    return guest;\n}\n\nfunction counta() {\n    var r = 0;\n    for (var i = arguments.length; i--;) {\n        var arg = arguments[i];\n        if (Array.isArray(arg)) {\n            var matrix = arg;\n            for (var j = matrix.length; j--;) {\n                for (var k = matrix[j].length; k--;) {\n                    if (matrix[j][k] !== null && matrix[j][k] !== undefined) {\n                        r++;\n                    }\n                }\n            }\n        }\n        else {\n            if (arg !== null && arg !== undefined) {\n                r++;\n            }\n        }\n    }\n    return r;\n}\n\nfunction pmt(rate_per_period, number_of_payments, present_value, future_value, type) {\n    type = type || 0;\n    future_value = future_value || 0;\n    if (rate_per_period != 0.0) {\n        // Interest rate exists\n        var q = Math.pow(1 + rate_per_period, number_of_payments);\n        return -(rate_per_period * (future_value + (q * present_value))) / ((-1 + q) * (1 + rate_per_period * (type)));\n\n    }\n    else if (number_of_payments != 0.0) {\n        // No interest rate, but number of payments exists\n        return -(future_value + present_value) / number_of_payments;\n    }\n    return 0;\n}\n\nfunction _if(condition, _then, _else) {\n    if (condition) {\n        return _then;\n    }\n    else {\n        return _else;\n    }\n}\n\nfunction concatenate() {\n    var r = '';\n    for (var i = 0; i < arguments.length; i++) {\n        r += arguments[i];\n    }\n    return r;\n}\n\nfunction sum() {\n    //console.log('sum...');\n    var r = 0;\n    for (var i = arguments.length; i--;) {\n        var arg = arguments[i];\n        if (Array.isArray(arg)) {\n            var matrix = arg;\n            for (var j = matrix.length; j--;) {\n                for (var k = matrix[j].length; k--;) {\n                    if (!isNaN(matrix[j][k])) {\n                        r += +matrix[j][k];\n                    }\n                }\n            }\n        }\n        else {\n            r += +arg;\n        }\n    }\n    //console.log('end sum.');\n    return r;\n}\n\nfunction max() {\n    var max = null;\n    for (var i = arguments.length; i--;) {\n        var arg = arguments[i];\n        if (Array.isArray(arg)) {\n            var arr = arg;\n            for (var j = arr.length; j--;) {\n                max = max == null || max < arr[j] ? arr[j] : max;\n            }\n        }\n        else if (!isNaN(arg)) {\n            max = max == null || max < arg ? arg : max;\n        }\n        else {\n            console.log('WTF??', arg);\n        }\n    }\n    return max;\n}\n\nfunction min() {\n    var result = null;\n    for (var i = arguments.length; i--;) {\n        var arg = arguments[i];\n        if (Array.isArray(arg)) {\n            var arr = arg;\n            for (var j = arr.length; j--;) {\n                result = result == null || result > arr[j] ? arr[j] : result;\n            }\n        }\n        else if (!isNaN(arg)) {\n            result = result == null || result > arg ? arg : result;\n        }\n        else {\n            console.log('WTF??', arg);\n        }\n    }\n    return result;\n}\n\nfunction vlookup(key, matrix, return_index) {\n    for (var i = 0; i < matrix.length; i++) {\n        if (matrix[i][0] == key) {\n            return matrix[i][return_index - 1];\n        }\n    }\n    throw Error('#N/A');\n}\n\nmodule.exports = formulas;\n","\"use strict\";\n\nconst int_2_col_str = require('./int_2_col_str.js');\nconst col_str_2_int = require('./col_str_2_int.js');\nconst RawValue = require('./RawValue.js');\nconst Range = require('./Range.js');\nconst RefValue = require('./RefValue.js');\n\nfunction raw_offset(cell_ref, rows, columns, height, width) {\n    height = (height || new RawValue(1)).calc();\n    width = (width || new RawValue(1)).calc();\n    if (cell_ref.args.length === 1 && cell_ref.args[0].name === 'RefValue') {\n        var ref_value = cell_ref.args[0];\n        var parsed_ref = ref_value.parseRef();\n        var col = col_str_2_int(parsed_ref.cell_name) + columns.calc();\n        var col_str = int_2_col_str(col);\n        var row = +parsed_ref.cell_name.replace(/^[A-Z]+/g, '') + rows.calc();\n        var cell_name = col_str + row;\n        if (height === 1 && width === 1) {\n            return new RefValue(cell_name, ref_value.formula).calc();\n        }\n        else {\n            var end_range_col = int_2_col_str(col + width - 1);\n            var end_range_row = row + height - 1;\n            var end_range = end_range_col + end_range_row;\n            var str_expression = parsed_ref.sheet_name + '!' + cell_name + ':' + end_range;\n            return new Range(str_expression, ref_value.formula).calc();\n        }\n    }\n}\n\nfunction resolveOnErrorValue(onerrorvalue, resolve, reject) {\n    let v_or_promise = onerrorvalue.calc();\n    if (typeof v_or_promise === 'object' && typeof v_or_promise['then'] === 'function') {\n        //console.log('resolvendo onerrorvalue');\n        v_or_promise.then(r => {\n            //console.log('On error value =', r);\n            resolve(r);\n        }).catch(e=> {\n            //console.log('Erro no on error value');\n            reject(e);\n        });\n    } else {\n        //console.log('valor no caso de erro =', v_or_promise);\n        resolve(v_or_promise);\n    }\n}\n\nfunction iferror(cell_ref, onerrorvalue) {\n    return new Promise((resolve, reject) => {\n        try {\n            cell_ref.calc().then(value=>{\n                //console.log('tudo ok com o cell_ref...', typeof value);\n                if (typeof value === 'undefined') {\n                    resolveOnErrorValue(onerrorvalue, resolve, reject);\n                } else if (typeof value === 'number' && (isNaN(value) || value === Infinity || value === -Infinity)) {\n                    resolveOnErrorValue(onerrorvalue, resolve, reject);\n                } else {\n                    resolve(value);\n                }\n            }).catch(e => {\n                //console.log('2 error level');\n                resolveOnErrorValue(onerrorvalue, resolve, reject);\n            });\n        } catch(e) {\n            return onerrorvalue.calc();\n        }\n    });\n}\n\nmodule.exports = {\n    'OFFSET': raw_offset,\n    'IFERROR': iferror\n};\n","\"use strict\";\n\nconst RawValue = require('./RawValue.js');\nconst find_all_cells_with_formulas = require('./find_all_cells_with_formulas.js');\n\nclass Calculator {\n    \n    constructor(workbook, exec_formula) {\n        this.workbook = workbook;\n        this.expressions = [];\n        this.exec_formula = exec_formula;\n        this.variables = {};\n        let formulas = find_all_cells_with_formulas(workbook, exec_formula);\n        for (let i = formulas.length - 1; i >= 0; i--) {\n            let exp = exec_formula.build_expression(formulas[i]);\n            this.expressions.push(exp);\n        }\n    }\n    \n    setVar(var_name, value) {\n        let variable = this.variables[var_name];\n        if (variable) {\n            variable.setValue(value);\n        } else {\n            this.expressions.forEach(exp => {\n                this.setVarOfExpression(exp, var_name, value);\n            });\n        }\n    }\n    \n    setVarOfExpression(exp, var_name, value) {\n        for (let i = 0; i < exp.args.length; i++) {\n            let arg = exp.args[i];\n            if (arg === var_name) {\n                exp.args[i] = this.variables[var_name] || (this.variables[var_name] = new RawValue(value));\n            } else if (typeof arg === 'object' && (arg.name === 'Expression' || arg.name === 'UserFn')) {\n                this.setVarOfExpression(arg, var_name, value);\n            }\n        }\n    }\n    \n    execute() {\n        let promises = this.expressions.map(exp => {\n            return exp.update_cell_value();\n        });\n        return Promise.all(promises);\n    }\n}\n\nmodule.exports = Calculator;"],"sourceRoot":""}